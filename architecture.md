# Архитектурное предложение по обслуживанию 1200 email-адресов для аутрича

Цель: Минимальная стоимость, высокая отказоустойчивость, контролируемая ротация отправки.

Ключевая идея: Легкая serverless-архитектура с использованием очереди задач.

## Состав системы

Хранилище задач: Управляемая PostgreSQL (список адресов, статусы, лог отправок)
Очередь задач: Managed SQS / Redis Streams / RabbitMQ (легкая очередь)
Исполнение: AWS Lambda / Google Cloud Functions (или контейнеры на DigitalOcean/App Platform)
SMTP-инфраструктура: Пул из 2–4 SMTP-провайдеров (SES, Mailgun, SendGrid) с ротацией
Мониторинг: CloudWatch/Datadog + Grafana + лог-агрегатор (ELK/CloudWatch)

## Принцип работы ротации и мониторинга

Планировщик помещает задания в очередь с метаданными
Worker принимает задачу, выбирает провайдера по круговой очереди с проверкой работоспособности, выполняет отправку
При ошибках происходит переключение на следующий провайдер, экспоненциальная задержка повторных попыток, логирование
Мониторинг собирает информацию об отказах и жалобах, помечает адреса; при частых отказах адрес блокируется

## Распределение нагрузки

Очередь + автоскейлинг воркеров (Lambda масштабируется автоматически)
Параллелизация по направлениям/клиентам: отдельные очереди или теги для изоляции

## Риски и меры по их снижению

Блокировка провайдера/IP — использование резервных провайдеров и выделенных IP
Плохая репутация — настройка SPF/DKIM/DMARC, постепенное "разогревание" доменов/IP
Высокий процент отказов — автоматическая блокировка и валидация перед отправкой

## Оценка стоимости (минимальная)

Lambda: 20–40 USD/мес
Managed Postgres (small): 15–40 USD/мес
SMTP провайдер: 1–50 USD/мес (SES дешевле)
Мониторинг (базовый): 0–20 USD/мес

Итого: ориентировочно 40–150 USD/мес при минимальном наборе.